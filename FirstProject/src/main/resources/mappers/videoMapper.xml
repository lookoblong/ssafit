<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafy.board.model.dao.VideoDao">
    <resultMap type="Video" id="videoMap">
        <result column="video_id" property="videoId"/>
        <result column="video_title" property="videoTitle"/>
        <result column="video_part" property="videoPart"/>
        <result column="video_created_at" property="videoCreatedAt"/>
    	<result column="video_url" property="videoUrl"/>
    	<result column="video_view_cnt" property="videoViewCnt"/>
    </resultMap>

    <select id="selectAll" resultMap="videoMap" resultType="Video">
        SELECT * 
        FROM video;
    </select>
    
    <update id="increaseViewCnt" parameterType="int">
    	UPDATE video
    	SET video_view_cnt = video_view_cnt+1
    	WHERE video_id= #{videoId};
    </update>

    <select id="selectOne" resultMap="videoMap" parameterType="int">
        SELECT *
        FROM video
        WHERE video_id = #{videoId};
    </select>

    <insert id="insertVideo" parameterType="Video">
        INSERT INTO video (video_title, video_url, video_part)
        VALUES (#{videoTitle}, #{videoUrl}, #{videoPart});
    </insert>
    
    <delete id="deleteVideo" parameterType="int">
        DELETE FROM video
        WHERE video_id = #{videoId};
    </delete>
    
    <update id="updateVideo" parameterType="video">
        UPDATE video
        SET video_title = #{videoTitle}, video_part = #{videoPart}, video_created_at = now()
        WHERE video_id = #{videoId};
    </update>
    
    <insert id="bookmark" parameterType="VideoBookmark">
    	INSERT INTO bookmarks
    	VALUES (#{userId}, #{videoId});
    </insert>
    
    <delete id="unbookmark" parameterType="VideoBookmark">
    	DELETE FROM bookmarks
    	WHERE (user_id, video_id) = (#{userId}, #{videoId});
    </delete>
    
    <select id="bookmarkFind" parameterType="String">
    	SELECT video_id videoId 
    	FROM bookmarks
    	WHERE user_id = #{userId};
    </select>
    
</mapper>